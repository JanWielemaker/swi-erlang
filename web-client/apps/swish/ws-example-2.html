<html lang="en">
    <head>
		<script>
		    var ws = new WebSocket('ws://localhost:3060/ws', 'web_prolog'); 
		    var program = "echo :- pengine_input(?,N), pengine_output(N), echo.";
			var id = Math.random().toString(36);
		    ws.onerror = function(message) {
		        console.log(message);
		    };
		    ws.onopen = function(message) {
				ws.send(JSON.stringify({action:"pengine_spawn", options:'[reply_to("'+id+'"),src_text("'+program+'")]'}));
		    };
		    ws.onmessage = function(message) {
		        var event = JSON.parse(message.data);
		        if (event.type == "spawned") {
					ws.send(JSON.stringify({action:"pengine_ask", pid:event.pid, goal:"echo"}));
		        } else if (event.type == "prompt") {
		            var response = prompt(event.data);
                    ws.send(JSON.stringify({action:"pengine_respond", pid:event.pid, term:response}));
		        } else if (event.type == "output") {
		            document.getElementById("output").innerText += event.data + "\n";
		        } 
		    }; 
		</script>
    </head>
    <body>
		<div style="font-size:130%" id="output"></div>
    </body>
</html>
